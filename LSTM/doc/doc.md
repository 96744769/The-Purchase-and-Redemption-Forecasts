# 基于长短期记忆神经网络的余额宝资金流入流出预测及其Python实现

## 背景
余额宝拥有数以亿计的客户，且每天都涉及大量的资金流入和流出。在用户数量大、资金数额大，双重因素导致下，资金管理压力也非常大。既要保证资金的流动性，又要满足日常业务运转的情况。在此情况下，如何预测资金的流入流出情况变得尤为重要。

> 数据来自于阿里巴巴。地址如下：
> https://tianchi.aliyun.com/competition/entrance/231573/information

一共有四张表。分别是：用户信息表、用户申购赎回数据表、收益率表和上海银行间同业拆放利率（Shibor）表。因为采用了基于长短期记忆神经网络的方案，只用到了用户申购赎回数据表，这里只介绍用户申购数据表。

用户申购赎回数据表包含了 20130701 至 20140831 申购和赎回信息、以及所有的子类目信息， 数据经过脱敏处理。脱敏之后的数据，基本保持了原数据趋势。数据主要包括用户操作时间和操作记录，其中操作记录包括申购和赎回两个部分。金额的单位是分，即 0.01 元人民币。 如果用户今日消费总量为0，即consume_amt=0，则四个字类目为空。

| 列名 | 类型 | 含义 | 示例 |
| --- | --- | --- | --- |
| user_id | bigint | 用户 id | 1234 |
| report_date | string | 日期 |20140407 |
| tBalance | bigint | 今日余额 | 109004 |
| yBalance | bigint | 昨日余额 | 97389 |
| total_purchase_amt | bigint | 今日总购买量 = 直接购买 + 收益 | 21876 |
| direct_purchase_amt | bigint | 今日直接购买量 | 21863 |
| purchase_bal_amt | bigint | 今日支付宝余额购买量 | 0 |
| purchase_bank_amt | bigint | 今日银行卡购买量 | 21863 |
| total_redeem_amt | bigint | 今日总赎回量 = 消费 + 转出 | 10261 |
| consume_amt | bigint | 今日消费总量 | 0 |
| transfer_amt | bigint | 今日转出总量 | 10261 |
| tftobal_amt | bigint | 今日转出到支付宝余额总量 | 0|
| tftocard_amt | bigint | 今日转出到银行卡总量 | 10261 |
| share_amt | bigint | 今日收益 | 13 |
| category1 | bigint | 今日类目 1 消费总额 | 0|
| category2 | bigint | 今日类目 2 消费总额 | 0|
| category3 | bigint | 今日类目 3 消费总额 | 0|
| category4 | bigint | 今日类目 4 消费总额 | 0|

注：
* 上述的数据都是经过脱敏处理的，收益为重新计算得到的，计算方法按照简化后的计算方式处理，具体计算方式在下节余额宝收益计算方式中描述。
* 脱敏后的数据保证了今日余额 = 昨日余额 + 今日申购 - 今日赎回，不会出现负值。

我们利用长短期记忆神经网络方法，分别对资金的流入和资金的流出进行预测。利用历史数据，尝试预测未来一个月的资金流入流出预测。

## 循环神经网络
